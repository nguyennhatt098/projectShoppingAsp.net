@using Model
@model IEnumerable<Model.Product>
@{
	ViewBag.Title = "Trang Chủ";
	Layout = "~/Views/Shared/_Layout.cshtml";
	var ListProductNew = (List<Model.Product>)ViewBag.ListProductNew;
	var wishList = (List<Model.WishList>)ViewBag.wishList;
	var user = (User)Session["User"];
	var listNews = (List<Model.News>)ViewBag.ListNews;
	var reviewProductList = (List<ReviewProduct>)ViewBag.ReviewList;
}


<!-- header end -->
<!-- slider-container start -->
@{Html.RenderAction("Slider", "Home");}
<!-- slider-container end -->
<!-- banner-area start -->
<div class="banner-area pt-70">
	<div class="container">
		<div class="row">
			<div class="col-md-6 col-sm-6">
				<div class="single-banner">
					<a href="javascript:void(0)"><img src="~/asset/frontend/img/banner/1.jpg" alt="" /></a>
				</div>
			</div>
			<div class="col-md-6 col-sm-6">
				<div class="single-banner">
					<a href="javascript:void(0)"><img src="~/asset/frontend/img/banner/2.jpg" alt="" /></a>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- banner-area end -->
<!-- new-arrival-area start -->
<div class="new-arrival-area pt-100 reload-wish">
	<div class="container">
		<div class="row">
			<div class="section-title text-center mb-20">
				<h2>Sản Phẩm Nổi Bật</h2>
			</div>
		</div>
		<div class="row ">
			<div class="col-md-12">
				<div class="product-tab">
					<!-- Nav tabs -->
					<!-- Tab panes -->
					<div class="row">
						<div class="tab-content ">
							<div class="tab-pane active" id="home">
								<div class="product-carousel">
									@foreach (var item in Model)
									{
										float totalStar = 0;
										var reviewProducts = reviewProductList.Where(x => x.ProductId == item.Id).Select(x=>new Model.ReviewProduct
										{
											ProductId = x.Id,
											Rate = x.Rate
										}).ToList();
										foreach (var itemReview in reviewProducts)
										{
											totalStar += itemReview.Rate;

										}
										float currentStar = totalStar / reviewProducts.Count();
										var url = "/chi-tiet-san-pham/" + item.Slug + "-" + item.Id;

										<div class="col-md-12">
											<div class="product-wrapper mb-40  ">
												<div class="product-img">
													<a href="@url"><img class="lazy" src="@item.Images" alt="@item.Name" /></a>
													@if (item.TopHot)
													{
														<span class="new-label-hot">Hot</span>
													}

													<div class="product-action">
														<a href="/them-vao-gio-hang?productID=@item.Id&quantity=1"><i class="pe-7s-cart"></i></a>

														@if (user == null)
														{
															<a data-toggle="modal" data-target="#exampleModalCenter" href="#"><i class="fa fa-heart"></i></a>
														}
														else if (wishList.Any(x => x.ProductID.Equals(item.Id)))
														{
															<a class="wishlist wishlistDisLike wishlist-@item.Id" id="@item.Id" data-id="@item.Id" href="javascript:void(0)"><i class="fa fa-heart"></i></a>
														}
														else
														{
															<a class="wishlist wishlist-@item.Id" data-id="@item.Id" id="@item.Id" href="javascript:void(0)"><i class="fa fa-heart"></i></a>
														}

														<a href="@url"><i class="pe-7s-look"></i></a>
													</div>
												</div>
												<div class="product-content">
													<div class="pro-title">
														<h3><a href="@url">@item.Name</a></h3>
													</div>
													<div class="price-reviews">
														<div class="price-box">

															@if (item.Sale_Price != null)
															{
																<span class="old-price product-price">@String.Format("{0:n0}", item.Price)  VND</span> <span class="price product-price">@String.Format("{0:n0}", item.Sale_Price) VND</span>
															}
															else
															{
																<span class="price product-price">@String.Format("{0:n0}", item.Price) VND</span>
															}

														</div>
														<div class="pro-rating">
															@if (reviewProducts.Count > 0)
															{
																var check = true;
																for (int i = 1; i <= 5; i++)
																{
																	if (i <= currentStar)
																	{
																		<i class="fa fa-star"></i>

																	}
																	else if ( (Math.Abs(currentStar - Math.Floor(currentStar)) > 0)&&check)
																	{
																		check = false;
																		<i class="fa fa-star-half-o" aria-hidden="true"></i>
																	}
																	else
																	{
																		<i class="fa fa-star-o" aria-hidden="true"></i>
																	}
																}
															}
														</div>
													</div>
												</div>
											</div>
										</div>
									}
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>



<div class="best-sell-area pt-30">
	<div class="container">
		<div class="row">
			<div class="section-title text-center mb-50">
				<h2>Sản Phẩm Mới Nhất</h2>
			</div>
		</div>
		<div class="row">
			<div class="product-carousel">
				@foreach (var item in ListProductNew)
				{
					float totalStar = 0;
					var reviewProducts = reviewProductList.Where(x => x.ProductId == item.Id).Select(x=>new Model.ReviewProduct
					{
						ProductId = x.Id,
						Rate = x.Rate
					}).ToList();
					foreach (var itemReview in reviewProducts)
					{
						totalStar += itemReview.Rate;

					}
					float currentStar = totalStar / reviewProducts.Count();
					var url = "/chi-tiet-san-pham/" + item.Slug + "-" + item.Id;
					<div class="col-md-12">
						<div class="product-wrapper mb-40">
							<div class="product-img">
								<a href="@url"><img class="lazy" src="@item.Images" alt="@item.Name" /></a>
								<span class="new-label">New</span>
								<div class="product-action">
									<a href="/them-vao-gio-hang?productID=@item.Id&quantity=1"><i class="pe-7s-cart"></i></a>
									@if (user == null)
									{
										<a data-toggle="modal" data-target="#exampleModalCenter" href="#"><i class="fa fa-heart"></i></a>
									}
									else if (wishList.Any(x => x.ProductID.Equals(item.Id)))
									{
										<a class="wishlist wishlistDisLike wishlist-@item.Id" id="@item.Id" data-id="@item.Id" href="javascript:void(0)"><i class="fa fa-heart"></i></a>
									}
									else
									{
										<a class="wishlist wishlist-@item.Id" data-id="@item.Id" id="@item.Id" href="javascript:void(0)"><i class="fa fa-heart"></i></a>
									}
									<a href="@url"><i class="pe-7s-look"></i></a>
								</div>
							</div>
							<div class="product-content">
								<div class="pro-title">
									<h3><a href="@url">@item.Name</a></h3>
								</div>
								<div class="price-reviews">
									<div class="price-box">
										@if (item.Sale_Price != null)
										{
											<span class="old-price product-price">@String.Format("{0:n0}", item.Price)  VND</span> <span class="price product-price">@String.Format("{0:n0}", item.Sale_Price) VND</span>
										}
										else
										{
											<span class="price product-price">@String.Format("{0:n0}", item.Price) VND</span>
										}
									</div>

									<div class="pro-rating">
										@if (reviewProducts.Count > 0)
										{
											var check = true;
											for (int i = 1; i <= 5; i++)
											{
												if (i <= currentStar)
												{
													<i class="fa fa-star"></i>

												}
												else if ( (Math.Abs(currentStar - Math.Floor(currentStar)) > 0)&&check)
												{
													check = false;
													<i class="fa fa-star-half-o" aria-hidden="true"></i>
												}
												else
												{
													<i class="fa fa-star-o" aria-hidden="true"></i>
												}
											}
										}
									</div>
								</div>
							</div>
						</div>

					</div>
				}
			</div>
		</div>
	</div>
</div>
<!-- best-sell-area end -->
<!-- latest-blog-area start -->
<div class="latest-blog-area ptb-60">
	<div class="container">
		<div class="row">
			<div class="section-title text-center mb-50">
				<h2>latest blog</h2>
			</div>
		</div>
		<div class="row">
			<div class="blog-active">
				@foreach (var item in listNews)
				{
					var url = "/chi-tiet-tin-tuc/" + item.Slug + "-" + item.ID;
					<div class="col-lg-12">
						<div class="blog-wrapper mb-40">
							<div class="blog-img">
								<a href="@url"><img src="@item.Images" alt="" /></a>
							</div>
							<div class="blog-info">
								<h3><a href="@url">@item.Summary</a></h3>
								<div class="blog-meta">
									<span class="f-left">@item.CreateDate</span>
									<span class="f-right"><a href="@url">Xem Thêm </a></span>
								</div>
							</div>
						</div>
					</div>
				}
			</div>
		</div>
	</div>
</div>
<!-- latest-blog-area end -->
<!-- brand-area start -->
<div class="brand-area">
	<div class="container">
		<div class="brand-sep ptb-50">
			<div class="row">
				<div class="brand-active">
					<div class="col-lg-12">
						<div class="single-brand">
							<a href="#" ><img  src="~/Asset/FrontEnd/img/brand/1.jpg" alt="" /></a>
						</div>
					</div>
					<div class="col-lg-12">
						<div class="single-brand">
							<a href="#"><img src="~/Asset/FrontEnd/img/brand/2.jpg" alt="" /></a>
						</div>
					</div>
					<div class="col-lg-12">
						<div class="single-brand">
							<a href="#"><img src="~/Asset/FrontEnd/img/brand/3.jpg" alt="" /></a>
						</div>
					</div>
					<div class="col-lg-12">
						<div class="single-brand">
							<a href="#"><img src="~/Asset/FrontEnd/img/brand/4.jpg" alt="" /></a>
						</div>
					</div>
					<div class="col-lg-12">
						<div class="single-brand">
							<a href="#"><img src="~/Asset/FrontEnd/img/brand/5.jpg" alt="" /></a>
						</div>
					</div>
					<div class="col-lg-12">
						<div class="single-brand">
							<a href="#"><img src="~/Asset/FrontEnd/img/brand/1.jpg" alt="" /></a>
						</div>
					</div>
					<div class="col-lg-12">
						<div class="single-brand">
							<a href="#"><img src="~/Asset/FrontEnd/img/brand/2.jpg" alt="" /></a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- brand-area end -->
<!-- service-area start -->
<!-- service-area end -->
<!-- footer start -->